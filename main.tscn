[gd_scene load_steps=42 format=3 uid="uid://jeth6hp8pbu3"]

[ext_resource type="Theme" uid="uid://bb74rah8n7o5x" path="res://Theme.tres" id="1_1bvp3"]
[ext_resource type="Script" uid="uid://bu0b2cvqebt01" path="res://main.gd" id="1_7mycd"]
[ext_resource type="PackedScene" uid="uid://8h3hxuwkofx6" path="res://arena/Arena.tscn" id="1_ig7tw"]
[ext_resource type="Shader" uid="uid://b7ylttcjjhm17" path="res://background.gdshader" id="1_lquwl"]
[ext_resource type="PackedScene" uid="uid://dhhhsdiubg8h" path="res://FallingBlocks/fallingBlockScene.tscn" id="2_0xm2m"]
[ext_resource type="Script" uid="uid://c85yxaouivtfy" path="res://UI/music_control.gd" id="2_7mycd"]
[ext_resource type="Script" uid="uid://cr0jdmd8rtkjr" path="res://pause_menu.gd" id="2_272bh"]
[ext_resource type="Script" uid="uid://ck3pjawuj4osq" path="res://UI/fullscreen_control.gd" id="3_272bh"]
[ext_resource type="Script" uid="uid://dw045br18flj6" path="res://GameStates/StartState.gd" id="3_efxa6"]
[ext_resource type="Script" uid="uid://drign7lf3nhos" path="res://FallingBlocks/Scripts/camera_orbiting.gd" id="3_h2yge"]
[ext_resource type="Script" uid="uid://dgsfskwfqnpll" path="res://GameStates/InterState.gd" id="4_dg77c"]
[ext_resource type="PackedScene" uid="uid://buvrp1m3nq40a" path="res://Animations/StartingAnimation.tscn" id="4_ycdy4"]
[ext_resource type="PackedScene" uid="uid://hobpokn16d78" path="res://UI/MainMenu.tscn" id="5_lswn8"]
[ext_resource type="Script" uid="uid://dcii83uba36ms" path="res://GameStates/GameOverState.gd" id="5_ycdy4"]
[ext_resource type="AudioStream" uid="uid://c7fhpq12bxvgn" path="res://Audio/sfx/Click_01.wav" id="6_a6jrf"]
[ext_resource type="Script" uid="uid://d0k67lx4tmh4i" path="res://GameStates/FallingState.gd" id="6_w48qg"]
[ext_resource type="Script" uid="uid://boyncuja5e588" path="res://UI/sfx_control.gd" id="6_yaehf"]
[ext_resource type="PackedScene" uid="uid://ccmo8cbr53nrq" path="res://Animations/InterAnimation.tscn" id="6_ycdy4"]
[ext_resource type="Texture2D" uid="uid://dj2h7p4qi5utl" path="res://Sprite/Buttons/quit-button.png" id="8_ryguw"]
[ext_resource type="Texture2D" uid="uid://bflsoeiwwaapd" path="res://Sprite/Buttons/quit-button-pressed.png" id="9_d13ii"]
[ext_resource type="Texture2D" uid="uid://caf4ewhe5ltco" path="res://Sprite/Buttons/play-button-focus.png" id="10_1u8w0"]
[ext_resource type="Script" uid="uid://drw0u0trca3q" path="res://Player/FSM/StateMachine.gd" id="10_2cqfq"]
[ext_resource type="Texture2D" uid="uid://cgsg7vvvrke0g" path="res://Sprite/Buttons/restart-button.png" id="11_0odxb"]
[ext_resource type="Texture2D" uid="uid://dtt2oq60u7bn5" path="res://Sprite/Buttons/mm-button.png" id="11_1u8w0"]
[ext_resource type="Texture2D" uid="uid://dqcu3ufd1rkk" path="res://Sprite/Buttons/mm-button-pressed.png" id="12_0odxb"]
[ext_resource type="Texture2D" uid="uid://d4kh8md2aw1yd" path="res://Sprite/Buttons/restart-button-pressed.png" id="12_lswn8"]
[ext_resource type="Shader" uid="uid://d1afbvfeg3l66" path="res://Animations/animShader.gdshader" id="26_lswn8"]
[ext_resource type="Script" uid="uid://gbn7xt6ng0so" path="res://animation_player.gd" id="27_a6jrf"]
[ext_resource type="PackedScene" uid="uid://0an4hy4s4i3f" path="res://Animations/EndAnimation.tscn" id="27_kq58d"]

[sub_resource type="ShaderMaterial" id="ShaderMaterial_7mycd"]
shader = ExtResource("1_lquwl")
shader_parameter/background_color = Color(0.0373334, 0, 0.14, 1)
shader_parameter/line_color = Color(0.454902, 0, 0.65098, 1)
shader_parameter/line_freq = 9.21
shader_parameter/height = 0.6
shader_parameter/speed = 0.09
shader_parameter/scale = Vector2(2, 16)

[sub_resource type="ViewportTexture" id="ViewportTexture_0xm2m"]
viewport_path = NodePath("2dverse")

[sub_resource type="ViewportTexture" id="ViewportTexture_1bvp3"]
viewport_path = NodePath("3dcam")

[sub_resource type="ViewportTexture" id="ViewportTexture_lquwl"]
viewport_path = NodePath("3dverse")

[sub_resource type="StyleBoxTexture" id="StyleBoxTexture_5vw27"]

[sub_resource type="StyleBoxLine" id="StyleBoxLine_ycdy4"]
thickness = 8

[sub_resource type="StyleBoxLine" id="StyleBoxLine_w48qg"]
color = Color(0.7, 0.7, 0.7, 1)
thickness = 6

[sub_resource type="StyleBoxLine" id="StyleBoxLine_vivmo"]
color = Color(1, 1, 1, 1)
thickness = 6

[sub_resource type="ShaderMaterial" id="ShaderMaterial_a6jrf"]
shader = ExtResource("26_lswn8")
shader_parameter/use_sprite_alpha = true
shader_parameter/use_transition_texture = false
shader_parameter/transition_type = 0
shader_parameter/position = Vector2(0.5, 0.5)
shader_parameter/invert = true
shader_parameter/grid_size = Vector2(48, 27)
shader_parameter/rotation_angle = 0.0
shader_parameter/stagger = Vector2(0, 0)
shader_parameter/stagger_frequency = Vector2i(2, 2)
shader_parameter/flip_frequency = Vector2i(1, 1)
shader_parameter/basic_feather = 1.0
shader_parameter/use_mask_size = false
shader_parameter/mask_size = Vector2(100, 100)
shader_parameter/edges = 8
shader_parameter/shape_feather = 0.0
shader_parameter/sectors = 1
shader_parameter/clock_feather = 0.0
shader_parameter/progress = 0.0
shader_parameter/progress_bias = Vector2(2.5, 2.5)

[sub_resource type="Animation" id="Animation_qsp4k"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("ColorRect:material:shader_parameter/progress")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [0.0]
}

[sub_resource type="Animation" id="Animation_xuqvo"]
resource_name = "startanimation"
length = 3.0
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("ColorRect:material:shader_parameter/progress")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.5),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [25.0, 0.0]
}
tracks/1/type = "method"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("AnimationPlayer")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 3.03333),
"transitions": PackedFloat32Array(1, 1),
"values": [{
"args": [],
"method": &"toggle_time"
}, {
"args": [],
"method": &"toggle_time"
}]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_kq58d"]
_data = {
&"RESET": SubResource("Animation_qsp4k"),
&"startanimation": SubResource("Animation_xuqvo")
}

[node name="Main" type="Node2D" node_paths=PackedStringArray("SM", "HUD", "scoreLabel")]
script = ExtResource("1_7mycd")
SM = NodePath("StateMachine")
HUD = NodePath("HUD")
scoreLabel = NodePath("HUD/Score")

[node name="HUD" type="CanvasLayer" parent="."]

[node name="Score" type="Label" parent="HUD"]
offset_left = 1040.0
offset_top = 691.0
offset_right = 1114.0
offset_bottom = 714.0
text = "Score : 0"

[node name="UI" type="PanelContainer" parent="."]
material = SubResource("ShaderMaterial_7mycd")
offset_right = 720.0
offset_bottom = 720.0
size_flags_horizontal = 3
size_flags_vertical = 3
theme = ExtResource("1_1bvp3")

[node name="HBoxContainer" type="HBoxContainer" parent="UI"]
layout_mode = 2

[node name="Arena" type="TextureRect" parent="UI/HBoxContainer"]
layout_mode = 2
size_flags_horizontal = 3
texture = SubResource("ViewportTexture_0xm2m")

[node name="VBoxContainer" type="VBoxContainer" parent="UI/HBoxContainer"]
layout_mode = 2

[node name="topCamera" type="TextureRect" parent="UI/HBoxContainer/VBoxContainer"]
layout_mode = 2
texture = SubResource("ViewportTexture_1bvp3")

[node name="sideCamera" type="TextureRect" parent="UI/HBoxContainer/VBoxContainer"]
layout_mode = 2
texture = SubResource("ViewportTexture_lquwl")

[node name="Pause" type="Control" parent="UI"]
layout_mode = 2
script = ExtResource("2_272bh")
menuScene = ExtResource("5_lswn8")
buttonSound = ExtResource("6_a6jrf")

[node name="Panel" type="Panel" parent="UI/Pause"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
theme_override_styles/panel = SubResource("StyleBoxTexture_5vw27")

[node name="PanelSettings" type="Panel" parent="UI/Pause"]
layout_mode = 1
anchors_preset = -1
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = 793.0
offset_top = 79.0
offset_right = -54.0
offset_bottom = -77.0
grow_horizontal = 2
grow_vertical = 2

[node name="VBoxContainer2" type="VBoxContainer" parent="UI/Pause/PanelSettings"]
layout_mode = 0
offset_right = 433.0
offset_bottom = 557.0
theme_override_constants/separation = 60

[node name="VBoxContainer" type="VBoxContainer" parent="UI/Pause/PanelSettings/VBoxContainer2"]
layout_mode = 2
theme_override_constants/separation = 10

[node name="Label" type="Label" parent="UI/Pause/PanelSettings/VBoxContainer2/VBoxContainer"]
layout_mode = 2
theme_override_font_sizes/font_size = 50
text = "Settings"
horizontal_alignment = 1

[node name="HBoxContainer" type="HBoxContainer" parent="UI/Pause/PanelSettings/VBoxContainer2/VBoxContainer"]
layout_mode = 2
theme_override_constants/separation = 32
alignment = 1

[node name="Label2" type="Label" parent="UI/Pause/PanelSettings/VBoxContainer2/VBoxContainer/HBoxContainer"]
layout_mode = 2
text = "Music volume"

[node name="HSlider" type="HSlider" parent="UI/Pause/PanelSettings/VBoxContainer2/VBoxContainer/HBoxContainer"]
custom_minimum_size = Vector2(150, 0)
layout_mode = 2
theme_override_styles/slider = SubResource("StyleBoxLine_ycdy4")
theme_override_styles/grabber_area = SubResource("StyleBoxLine_w48qg")
theme_override_styles/grabber_area_highlight = SubResource("StyleBoxLine_vivmo")
max_value = 1.0
step = 0.05
value = 1.0
script = ExtResource("2_7mycd")

[node name="HBoxContainer2" type="HBoxContainer" parent="UI/Pause/PanelSettings/VBoxContainer2/VBoxContainer"]
layout_mode = 2
theme_override_constants/separation = 50
alignment = 1

[node name="label2" type="Label" parent="UI/Pause/PanelSettings/VBoxContainer2/VBoxContainer/HBoxContainer2"]
layout_mode = 2
text = "SFX volume"

[node name="SFXVolumeSlider" type="HSlider" parent="UI/Pause/PanelSettings/VBoxContainer2/VBoxContainer/HBoxContainer2"]
custom_minimum_size = Vector2(150, 0)
layout_mode = 2
script = ExtResource("6_yaehf")

[node name="FullscreenControl" type="CheckButton" parent="UI/Pause/PanelSettings/VBoxContainer2/VBoxContainer"]
layout_mode = 2
size_flags_horizontal = 4
text = "Fullscreen"
script = ExtResource("3_272bh")

[node name="MainButtons" type="VBoxContainer" parent="UI/Pause/PanelSettings/VBoxContainer2"]
layout_mode = 2

[node name="Restart" type="TextureButton" parent="UI/Pause/PanelSettings/VBoxContainer2/MainButtons"]
layout_mode = 2
texture_normal = ExtResource("11_0odxb")
texture_pressed = ExtResource("12_lswn8")
texture_focused = ExtResource("10_1u8w0")
stretch_mode = 5

[node name="Menu" type="TextureButton" parent="UI/Pause/PanelSettings/VBoxContainer2/MainButtons"]
layout_mode = 2
texture_normal = ExtResource("11_1u8w0")
texture_pressed = ExtResource("12_0odxb")
texture_focused = ExtResource("10_1u8w0")
stretch_mode = 3

[node name="Quit" type="TextureButton" parent="UI/Pause/PanelSettings/VBoxContainer2/MainButtons"]
layout_mode = 2
texture_normal = ExtResource("8_ryguw")
texture_pressed = ExtResource("9_d13ii")
texture_focused = ExtResource("10_1u8w0")
stretch_mode = 5

[node name="2dverse" type="SubViewport" parent="."]
transparent_bg = true
size = Vector2i(876, 714)

[node name="Arena" parent="2dverse" instance=ExtResource("1_ig7tw")]
nbEnnemies = 10
minSpawnRadius = 250.0
ennemySpacing = 170.0

[node name="3dverse" type="SubViewport" parent="."]
size = Vector2i(400, 450)

[node name="FallingBlocksScene" parent="3dverse" instance=ExtResource("2_0xm2m")]

[node name="Camera" type="Node3D" parent="3dverse"]
transform = Transform3D(0.707107, -0.121949, 0.696512, 0, 0.985016, 0.172462, -0.707107, -0.121949, 0.696512, 5.09455, 5.64783, 5.97738)

[node name="Camera3D" type="Camera3D" parent="3dverse/Camera"]
transform = Transform3D(1, 0, 0, 0, 1, 5.96046e-08, 0, 0, 1, 1, -1.325, -0.232)
current = true
script = ExtResource("3_h2yge")
target_pos = Vector3(0, 1, 0)
distance = 4.785
height = 0.895
offsetHeight = 1.705
speed = 8.0

[node name="3dcam" type="SubViewport" parent="."]
size = Vector2i(400, 260)

[node name="topCamera" type="Camera3D" parent="3dcam"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, 1, 0, -1, -4.37114e-08, 0, 56.2914, -0.051)
projection = 1
current = true
fov = 37.8493
size = 7.316

[node name="StateMachine" type="Node" parent="." node_paths=PackedStringArray("initial_state")]
script = ExtResource("10_2cqfq")
initial_state = NodePath("StartState")

[node name="StartState" type="Node" parent="StateMachine" node_paths=PackedStringArray("body")]
script = ExtResource("3_efxa6")
starAnimScene = ExtResource("4_ycdy4")
body = NodePath("../..")

[node name="InterState" type="Node" parent="StateMachine" node_paths=PackedStringArray("body")]
script = ExtResource("4_dg77c")
nbTypesOfPlatforms = 3
interAnimScene = ExtResource("6_ycdy4")
body = NodePath("../..")

[node name="GameOverState" type="Node" parent="StateMachine" node_paths=PackedStringArray("body")]
script = ExtResource("5_ycdy4")
endAnimation = ExtResource("27_kq58d")
body = NodePath("../..")

[node name="FallingState" type="Node" parent="StateMachine" node_paths=PackedStringArray("body")]
script = ExtResource("6_w48qg")
body = NodePath("../..")

[node name="ColorRect" type="ColorRect" parent="."]
material = SubResource("ShaderMaterial_a6jrf")
offset_right = 1286.0
offset_bottom = 720.0
color = Color(0.426376, 0.0016995, 0.667273, 1)

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]
libraries = {
&"": SubResource("AnimationLibrary_kq58d")
}
script = ExtResource("27_a6jrf")

[connection signal="value_changed" from="UI/Pause/PanelSettings/VBoxContainer2/VBoxContainer/HBoxContainer/HSlider" to="UI/Pause/PanelSettings/VBoxContainer2/VBoxContainer/HBoxContainer/HSlider" method="_on_value_changed"]
[connection signal="toggled" from="UI/Pause/PanelSettings/VBoxContainer2/VBoxContainer/FullscreenControl" to="UI/Pause/PanelSettings/VBoxContainer2/VBoxContainer/FullscreenControl" method="_on_toggled"]
[connection signal="button_up" from="UI/Pause/PanelSettings/VBoxContainer2/MainButtons/Restart" to="UI/Pause" method="_on_restart_button_up"]
[connection signal="button_up" from="UI/Pause/PanelSettings/VBoxContainer2/MainButtons/Menu" to="UI/Pause" method="_on_menu_button_up"]
[connection signal="button_up" from="UI/Pause/PanelSettings/VBoxContainer2/MainButtons/Quit" to="UI/Pause" method="_on_quit_button_up"]
